---
title: "FinalProject(clean)"
output: html_document
date: "2023-12-08"
---
US Obesity prevalence dataframe
```{r echo=FALSE, warning=FALSE, message = FALSE}
library(magrittr)
library(dplyr)
library(stringr)
library(magick)
library(ggplot2)
library(ggpubr)
overallObesity <- read.csv("data/obesity.csv")
overallObesity <- overallObesity %>%
  select(-X95CI)
head(overallObesity)
```
Dataframe for people who at least have a bachelors degree in the US
```{r echo=FALSE, warning=FALSE, message = FALSE}
education_BD <- read.csv("education_fixed_BD.csv")
education_BD <- education_BD[-c(1:5,57:64),]
education_BD<- education_BD[-1,]
education_BD <- education_BD %>%
  select(-X)
education_BD <- dplyr::rename(education_BD,State=Education..At.least.bachelors.degree..by.State,Value_Percent_BD=X.1,people_BD=X.2,rank_BD=X.3)
education_BD <- education_BD %>%
  arrange(State)
head(education_BD)
```
Dataframe for people who have less than a high school education
```{r echo=FALSE, warning=FALSE, message = FALSE}
education_HS <- read.csv("education_fixed_HS.csv")
education_HS <- education_HS[-c(1:6,57:64),]
education_HS <- education_HS %>%
  select(-X)
education_HS <- dplyr::rename(education_HS,State=Education..Less.than.High.School..by.State,Value_Percent_HS=X.1,people_HS=X.2,rank_HS=X.3)
education_HS <- education_HS %>%
  arrange(State)
head(education_HS)
```
Dataframe for people who have less than a 9th grade eudcation
```{r echo=FALSE, warning=FALSE, message = FALSE}
education_9th <- read.csv("education_9th_fixed.csv")
education_9th <- education_9th[-c(1:6,57:64),]
education_9th <- education_9th %>%
  select(-X) %>%
  rename(State=Education..Less.than.9th.grade..by.State,Value_Percent_9th=X.1,people_9th=X.2,rank_9th=X.3)
head(education_9th)
```
Dataframe for average household income across the US in each state
```{r echo=FALSE, warning=FALSE, message = FALSE}
income <- read.csv("income_fixed.csv")
income <- income[-c(1:5,57:64),]
income <- income %>%
  select(-X) %>%
  rename(State=Income..Median.household.income..by.State,state_income=X.1,income_rank=X.2)
head(income)
```
Combined dataframe of education, income, and obesity prevalence
```{r echo=FALSE, warning=FALSE, message = FALSE}
data <- education_BD %>%
  full_join(education_HS) %>%
  full_join(income) %>%
  full_join(education_9th)
data <- data %>%
  arrange(State)
overallObesity$State <- trimws(tolower(overallObesity$State))
data$State <- trimws(tolower(data$State))
fullData <- overallObesity %>%
  full_join(data)
head(fullData)
```

```{r echo=FALSE, warning=FALSE, message = FALSE}
fullData <- fullData %>%
  arrange(State)
fullData$stateAbreviation <- c("AL", "AK", "AZ", "AR", "CA", "CO", "CT", "DC", "DE", "FL", "GA", "GU", "HI", "ID", "IL", "IN", "IA", "KS", "KY", "LA", "ME", "MD", "MA", "MI", "MN", "MS", "MO", "MT", "NE", "NV", "NH", "NJ", "NM", "NY", "NC", "ND", "OH", "OK", "OR", "PA", "PR", "RI", "SC", "SD", "TN", "TX", "UT", "VT", "VI", "VA", "WA", "WV", "WI", "WY")
```
State income and obesity prevalence dataframe
```{r echo=FALSE, warning=FALSE, message = FALSE}
fullData4 <- fullData %>%
  select(state_income,State,Prevalence,stateAbreviation)
fullData4$state_income <- as.numeric(fullData4$state_income)
fullData4 <- arrange(fullData4,state_income)
fullData4 <- fullData4 %>%
  arrange(state_income)
head(fullData4)
fourthPlot <- fullData4 %>%
  ggplot(aes(state_income,Prevalence)) + 
  geom_point(col="lightblue",size=13) +
  geom_text(aes(label = stateAbreviation), size = 6.5) +
  theme(
    axis.text = element_text(size = 13),
    axis.title = element_text(size = 20)
  ) + geom_smooth(aes(group=1),se=FALSE,method=lm) + stat_cor(method="pearson",label.x=81000,label.y=40) + labs(title="Prevalence in obesity vs State income",subtitle="dataset from the U.S. Department of Health and Human Services",x="State income($)", y="prevalence in obesity(%)")
ggsave("prevalencevsincome.png", plot = fourthPlot, width = 20, height = 8, units = "in")
```
Prevalence in obesity vs State income graph
```{r, out.width = "1200px", echo=FALSE, warning=FALSE, messages = FALSE}
knitr::include_graphics("prevalencevsincome.png")
```
Percent of people with at least a Bachelor's Degree and obesity prevalence dataframe
```{r echo=FALSE, warning=FALSE, message = FALSE}
fullData1 <- fullData %>%
  select(Value_Percent_BD,State,Prevalence,stateAbreviation)
fullData1$Value_Percent_BD <- as.numeric(fullData1$Value_Percent_BD)
fullData1 <- arrange(fullData1,Value_Percent_BD)
head(fullData1)
fifthPlot <- fullData1 %>%
  ggplot(aes(Value_Percent_BD,Prevalence)) + 
  geom_point(col="lightblue",size=13) +
  geom_text(aes(label = stateAbreviation), size = 6.5) + 
  theme(
    axis.text = element_text(size = 13),
    axis.title = element_text(size = 20)
  ) + scale_x_continuous(limits = c(21, 46)) + scale_y_continuous(limits = c(25, 42)) + stat_cor(method="pearson",label.x=40,label.y=40) + geom_smooth(aes(group=1),method=lm,se=FALSE) + labs(title="Prevalence in obesity vs percent of people with at least a bachelor's degree",subtitle="dataset from the U.S. Department of Health and Human Services",x="% of people", y="prevalence in obesity(%)")
ggsave("prevalencevsValueBD.png", plot = fifthPlot, width = 20, height = 8, units = "in")
```
Prevalence in obesity vs percent of people with at least a bachelor's degree graph
```{r, out.width = "1200px", echo=FALSE, warning=FALSE, message = FALSE}
knitr::include_graphics("prevalencevsValueBD.png")
```
Percent of people with less than a high school education and obesity prevalence dataframe
```{r echo=FALSE, warning=FALSE, message = FALSE}
fullData2 <- fullData %>%
  select(Value_Percent_HS,State,Prevalence,stateAbreviation)
fullData2$Value_Percent_HS <- as.numeric(fullData2$Value_Percent_HS)
fullData2 <- arrange(fullData2,Value_Percent_HS)
head(fullData2)
sixthPlot <- fullData2%>%
  ggplot(aes(Value_Percent_HS,Prevalence)) + 
  geom_point(col="lightblue",size=13) +
  geom_text(aes(label = stateAbreviation), size = 6.5) +
  theme(
    axis.text = element_text(size = 13),
    axis.title = element_text(size = 20)
  ) + geom_smooth(aes(group=1),method=lm,se=FALSE) + stat_cor(method="pearson",label.x=7,label.y=40) + labs(title="Prevalence in obesity vs percent of people with less than high school education",subtitle="dataset from the U.S. Department of Health and Human Services",x="% of people", y="prevalence in obesity(%)")
ggsave("prevalencevsValueHS.png", plot = sixthPlot, width = 20, height = 8, units = "in")
```
Prevalence in obesity vs percent of people with less than high school education graph
```{r, out.width = "1200px", echo=FALSE, warning=FALSE, message = FALSE}
knitr::include_graphics("prevalencevsValueHS.png")
```
Percent of people with less than a 9th grade education and obesity prevalence dataframe
```{r echo=FALSE, warning=FALSE, message = FALSE}
fullData5 <- fullData %>%
  select(Value_Percent_9th,State,Prevalence,stateAbreviation)
fullData5$Value_Percent_9th <- as.numeric(fullData5$Value_Percent_9th)
fullData5 <- arrange(fullData5,Value_Percent_9th)
head(fullData5)
seventhPlot <- fullData5 %>%
  ggplot(aes(Value_Percent_9th,Prevalence)) + 
  geom_point(col="lightblue",size=13) +
  geom_text(aes(label = stateAbreviation), size = 6.5) +
  theme(
    axis.text = element_text(size = 13),
    axis.title = element_text(size = 20)
  ) + geom_smooth(aes(group=1),method=lm,se=FALSE) + stat_cor(method="pearson",label.x=7,label.y=40) + labs(title="Prevalence in obesity vs percent of people with less than 9th grade education",subtitle="dataset from the U.S. Department of Health and Human Services",x="% of people", y="prevalence in obesity(%)")
ggsave("prevalencevsValue9th.png", plot = seventhPlot, width = 20, height = 8, units = "in")
```
Prevalence in obesity vs percent of people with less than 9th grade education graph
```{r, out.width = "1200px", echo=FALSE, warning=FALSE, message = FALSE}
knitr::include_graphics("prevalencevsValue9th.png")
```